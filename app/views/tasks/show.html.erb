<div class="main">
  <div class="row">
    <div class="col-md-4 text-center">
      <%= image_tag avatar_url(@task), class: "round-img" %>
    </div>
    <div class="col-md-8">
      <div class="row">
        <h1><%= @task.title %></h1>
        <% if @task.user_id == current_user.id %>
          <%= link_to "課題編集", edit_team_assign_task_path(@task),
                                 class: "btn btn-outline-dark  profile-btn" %>
          <%= link_to "課題削除", team_assign_task_path(@task),
                                 method: :delete,
                                 data: { confirm: "課題を削除してもよろしいですか？"},
                                 class: "btn btn-danger  profile-btn" %>
        <% end %>
      </div>
      <div class="row">
        <p class="content"><%= @task.content %></p>
      </div>
      <% if @challenge_task.nil? %>
        <%= link_to "課題に取り組む！", team_assign_task_challenge_starts_path(user_id: current_user.id,
                                                                            team_id: @task.team_id,
                                                                            assign_id: @task.assign_id,
                                                                            task_id: @task.id), 
                                                                            method: :post,
                                                                            class: "btn btn-primary profile-btn" %>
      <% elsif  @challenge_task.status == "awaiting_review" && @answer.present? %>
        <%= link_to "回答を修正する", edit_team_assign_task_challenge_start_answer_path(team_id: @challenge_task.team_id,
                                                                                      assign_id: @challenge_task.assign_id, 
                                                                                      task_id: @challenge_task.task_id, 
                                                                                      challenge_start_id: @challenge_task.id, 
                                                                                      id: @answer.id), 
                                                                                      class: "btn btn-success profile-btn" %>
      <% else %>
        <%= link_to "回答する", new_team_assign_task_challenge_start_answer_path(team_id: @challenge_task.team_id,
                                                                               assign_id: @challenge_task.assign_id,
                                                                               task_id: @challenge_task.task_id,
                                                                               challenge_start_id: @challenge_task.id), 
                                                                               class: "btn btn-success profile-btn" %>
        <%= link_to "課題を諦める", team_assign_task_challenge_start_path(team_id: @task.team_id, 
                                                                        assign_id: @task.assign_id, 
                                                                        task_id: @task.id), 
                                                                        method: :delete, 
                                                                        data: { confirm: "本当に諦めますか？"}, 
                                                                        class: "btn btn-danger profile-btn" %>
      <% end %>
    </div>
  </div>
</div>
<div class="main_index">
  <div class="row">
    <% if @challenge_users.present? && @answer.present? && @user_status.status == "member" %>
      <% @challenge_users.each do |challenge_user| %>
        <div class="col-md-4">
          <div class="image-box">
            <div class="card-body">
              <div class="row parts">
                <%= link_to (image_tag challenge_user.user.image.url(:medium), class: "image-size"), team_assign_task_challenge_start_answer_path(user_id: challenge_user.user_id,
                                                                                                                                                  team_id: challenge_user.assign.team_id, 
                                                                                                                                                  assign_id: challenge_user.assign_id, 
                                                                                                                                                  task_id: challenge_user.task_id,
                                                                                                                                                  challenge_start_id: challenge_user.id),
                                                                                                                                                  id: @answer.id 
                                                                                                                                                  %>
                <div class="card-body">
                  <div>
                    <span><strong><%= challenge_user.user.name %></strong></span>
                    <%= link_to time_ago_in_words(challenge_user.updated_at).upcase + "前", team_assign_task_challenge_start_answer_path(user_id: challenge_user.user_id,
                                                                                                                                        team_id: challenge_user.assign.team_id, 
                                                                                                                                        assign_id: challenge_user.assign.id, 
                                                                                                                                        task_id: challenge_user.task_id,
                                                                                                                                        challenge_start_id: challenge_user.id),
                                                                                                                                        id: @answer.id,
                                                                                                                                        class: "team-time no-text-decoration" %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>
</div>